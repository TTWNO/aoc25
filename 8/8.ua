Input ← ≡(≡°□ ⋕ ⊜□ ⊸(¬=@,)°□) ⊜□ ⊸(¬=@\n) &fras "input.txt"
Dist  ← ⌵√ /+≡(ⁿ2 ⊢/-) ⍉
RL    ← ⍆◴⊂ ⟜(⊙(⍉˜⊟) ⊙⊙▽ ⊙(⊸˜▽) ⊸▽ ⊃(⊙⋅⋅∘|⋅⊙⊙⋅) ⊃(∘|¬) ⊙♭ /+⊸≡(=) ⊙⊃(¤⊢⍉|⊣⍉))
RR    ← ⍆◴⊂ ⟜(⊙(⍉⊟) ⊙⊙▽ ⊙(⊸˜▽) ⊸▽ ⊃(⊙⋅⋅∘|⋅⊙⊙⋅) ⊃(∘|¬) ⊙♭ /+⊸≡(=) ⊙⊃(¤⊣⍉|⊢⍉))
Ring  ← ⊃(⍆◴⊂⊙⋅∘|⋅⋅⋅⋅) ⊃(RR|RL)
TR    ← ◌⍢(⤚(◴⍆⊂) ⊙Ring|¬≍) ⊃(⊢|⊣) ⊸⊢
Next  ← ⟜(⊏ ⊙⍉⊚ ¬↥⊸⊃(/+ ≡= ⊙(¤⊢)|/+ ≡= ⊙(¤⊣)) ⊙⍉) ⊸TR
Rings ← ◌ ˜⍢(⊙(⨬(⊂□|⋅) ⊸≍[0]) ⊃(⋅∘|⊙⋅∘) Next|¬=0 /+/+) []

A ← /×↙3⇌⍆≡◇⧻ Rings ⊸⊛₁ ↙1001⊏⍏ ⊸≡Dist ⧅<2
# Too low: 26250
A Input
